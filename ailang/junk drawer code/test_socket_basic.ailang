// test_socket_basic.ailang
// Simple test to see if socket primitives work

SubRoutine.Main {
    PrintMessage("1. Testing SocketCreate\n")
    sock = SocketCreate()
    PrintMessage("   Result: ")
    PrintNumber(sock)
    PrintMessage("\n")
    
    IfCondition LessEqual(sock, 0) ThenBlock: {
        PrintMessage("   FAILED!\n")
        Exit()
    }
    
    PrintMessage("2. Testing SocketSetOption\n")
    SocketSetOption(sock, 1, 2, 1)
    PrintMessage("   Done\n")
    
    PrintMessage("3. Testing SocketBind\n")
    result = SocketBind(sock, 0, 8888)
    PrintMessage("   Result: ")
    PrintNumber(result)
    PrintMessage("\n")
    
    IfCondition LessThan(result, 0) ThenBlock: {
        PrintMessage("   FAILED!\n")
        SocketClose(sock)
        Exit()
    }
    
    PrintMessage("4. Testing SocketListen\n")
    result = SocketListen(sock, 5)
    PrintMessage("   Result: ")
    PrintNumber(result)
    PrintMessage("\n")
    
    IfCondition LessThan(result, 0) ThenBlock: {
        PrintMessage("   FAILED!\n")
        SocketClose(sock)
        Exit()
    }
    
    PrintMessage("5. All socket tests PASSED!\n")
    PrintMessage("   Cleaning up...\n")
    
    SocketClose(sock)
    PrintMessage("   Done!\n")
}

RunTask(Main)