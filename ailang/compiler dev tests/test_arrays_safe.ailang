// test_arrays_safe.ailang
// Test array operations without the problematic passing pattern

PrintMessage("Safe Array Operations Test")
PrintMessage("===========================")

// Test array creation and basic ops
arr = ArrayCreate(10)
PrintMessage("Created array of size 10")

// Test array set
ArraySet(arr, 0, 100)
ArraySet(arr, 1, 200)
ArraySet(arr, 9, 900)
PrintMessage("Set values at indices 0, 1, 9")

// Test array get
val0 = ArrayGet(arr, 0)
val1 = ArrayGet(arr, 1)
val9 = ArrayGet(arr, 9)

PrintMessage("arr[0] (should be 100):")
PrintNumber(val0)
PrintMessage("arr[1] (should be 200):")
PrintNumber(val1)
PrintMessage("arr[9] (should be 900):")
PrintNumber(val9)

// Test array with pool storage
FixedPool.ArrayPool {
    "shared_array": Initialize=0
}

// Store array in pool
ArrayPool.shared_array = arr
PrintMessage("Stored array in pool")

// Retrieve and use
retrieved = ArrayPool.shared_array
val_from_pool = ArrayGet(retrieved, 0)
PrintMessage("Retrieved arr[0] from pool (should be 100):")
PrintNumber(val_from_pool)

PrintMessage("All array tests passed!")