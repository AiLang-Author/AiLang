// test_performance.ailang
// Stress test the compiler and runtime

PrintMessage("Performance Test")
PrintMessage("================")

// Large loop test
counter = 0
limit = 100
PrintMessage("Counting to 100...")
WhileLoop LessThan(counter, limit) {
    counter = Add(counter, 1)
}
PrintMessage("Done. Final count:")
PrintNumber(counter)

// Many function calls
Function.Perf.Increment {
    Input: x:
    Body: {
        ReturnValue(Add(x, 1))
    }
}

val = 0
val = Perf.Increment(val)
val = Perf.Increment(val)
val = Perf.Increment(val)
val = Perf.Increment(val)
val = Perf.Increment(val)
PrintMessage("5 increments (should be 5):")
PrintNumber(val)

// Large array
big_array = ArrayCreate(100)
ArraySet(big_array, 0, 1)
ArraySet(big_array, 50, 2)
ArraySet(big_array, 99, 3)
sum = Add(ArrayGet(big_array, 0), Add(ArrayGet(big_array, 50), ArrayGet(big_array, 99)))
PrintMessage("Sum of sparse array elements (6):")
PrintNumber(sum)

PrintMessage("Performance test complete!")