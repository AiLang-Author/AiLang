// test_pool_real_performance.ailang
// Now that it actually works, let's see the REAL numbers

pool = StringPool.Init(65536)  // 64KB pool

// Test 1: Regular concat
DebugPerf.Start("regular_100")
str1 = "A"
i = 0
WhileLoop LessThan(i, 100) {
    
        str1 = StringConcat(str1, "B")
        i = Add(i, 1)
    }
    }
DebugPerf.End("regular_100")

// Test 2: Actually working pooled concat
DebugPerf.Start("pooled_100")
str2 = "A"
j = 0
WhileLoop LessThan(j, 100) {
    
        str2 = StringConcatPooled(str2, "B")
        j = Add(j, 1)
    }
    }
DebugPerf.End("pooled_100")

// Verify both actually concatenated
PrintMessage("Regular length:")
PrintNumber(StringLength(str1))  // Should be 101
PrintMessage("Pooled length:")
PrintNumber(StringLength(str2))   // Should be 101

PrintMessage("Pool usage:")
PrintNumber(StringPool.Status())